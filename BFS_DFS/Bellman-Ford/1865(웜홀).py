# https://www.acmicpc.net/problem/1865
# 1865. ì›œí™€ [ğŸ¥‡ ê³¨ë“œ 3] -> ğŸ”¥ ì˜¤ë‹µ í•„ìš”
# ğŸ“š ì•Œê³ ë¦¬ì¦˜ ë¶„ë¥˜: ë²¨ë§Œ í¬ë“œ 
# â° ê±¸ë¦° ì‹œê°„ : 42ë¶„ 
# ì‹œê°„ë³µì¡ë„ : O(VE)
# 
# [ë²¨ë§Œ í¬ë“œ ì•Œê³ ë¦¬ì¦˜ í‘¼ ê·¼ê±° ë° íšŒê³ ]
#  0. ìŒì˜ ê°€ì¤‘ì¹˜ë¥¼ ì‚¬ìš©í•œë‹¤. 
#  1. ìŒì˜ ê°€ì¤‘ì¹˜ë§Œ ìˆì„ ê²½ìš°ì—ëŠ” ë‹¤ìµìŠ¤íŠ¸ë¼ë¡œ í’€ ìˆ˜ ìˆì§€ë§Œ,
#  2. ìŒì˜ ì‚¬ì´í´ì´ ë°œìƒí•˜ëŠ” ë¬¸ì œëŠ” ìŒì˜ ì‚¬ì´í´ì„ ì²´í¬í•  ìˆ˜ ìˆëŠ” ë²¨ë§Œí¬ë“œë¡œ í’€ì–´ì•¼í•œë‹¤.
# 
# âœ”ï¸ [ë²¨ë§Œ í¬ë“œ ì „ì œ ì¡°ê±´]
# 0. ìµœë‹¨ ê²½ë¡œëŠ” ì‚¬ì´í´ì„ í¬í•¨í•  ìˆ˜ ì—†ê¸° ë•Œë¬¸ì—, ìµœëŒ€ V-1ê°œì˜ ê°„ì„ ë§Œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.
# 1. ê·¸ë˜ì•¼ ì‚¬ì´í´ì´ ë°œìƒí•˜ì§€ ì•ŠëŠ”ë‹¤!
#
# ğŸ’¡[ì¶œë°œì„ í•˜ì˜€ì„ ë•Œë³´ë‹¤ ì‹œê°„ì´ ë˜ëŒì•„ê°€ ìˆëŠ” ê²½ìš°ê°€ ìˆëŠ”ì§€] 
#  -> ìŒì˜ ì‚¬ì´í´ì´ ë°œìƒí•˜ë©´ ìƒê¸´ë‹¤!
# ------------------------------------------------------------
import sys
input = sys.stdin.readline

TC = int(input())
# N: ì§€ì ì˜ ìˆ˜, M: ë„ë¡œì˜ ê°œìˆ˜, W: ì›œí™€ì˜ ê°œìˆ˜
for t in range(TC):
    N ,M ,W = map(int,input().split())
    INF = int(1e9)
    times = [INF] * (N+1)
    roads = [[] for _ in range(N+1)]

    for i in range(M):
        #S: ì‹œì‘ì , E: ë„ì°© ì§€ì , T: ì¤„ì–´ë“œëŠ” ì‹œê°„
        S, E, T = map(int,input().split())
        roads[S].append((E,T))
        roads[E].append((S,T))
    for i in range(W):
        S, E, T = map(int,input().split())
        roads[S].append((E,-T))

    def bellman(start):
        times[start] = 0

        for i in range(1,N+1):
            for S in range(1,N+1):
                for E, T in roads[S]:
                    if times[E] > times[start]+T:
                        times[E] = times[start]+T
                        if i == N: #Në²ˆ ì´í›„ì—ë„ ê°’ì´ ê°±ì‹ ë˜ë©´ ìŒìˆ˜ ì‚¬ì´í´ ì¡´ì¬.
                            return print('YES')
        return print('NO')

    bellman(1)

